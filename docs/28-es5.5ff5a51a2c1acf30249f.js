function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function asyncGeneratorStep(e,r,t,n,a,o,i){try{var c=e[o](i),s=c.value}catch(l){return void t(l)}c.done?r(s):Promise.resolve(s).then(n,a)}function _asyncToGenerator(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var o=e.apply(r,t);function i(e){asyncGeneratorStep(o,n,a,i,c,"next",e)}function c(e){asyncGeneratorStep(o,n,a,i,c,"throw",e)}i(void 0)}))}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{GV60:function(e,r,t){"use strict";t.r(r),t.d(r,"amplify_s3_album",(function(){return w}));var n,a=t("bRKV"),o=t("Nt7R"),i=t("HzrR"),c=t("JIIv"),s=t("H8iN"),l=t("yMAf"),u=t("/vcS"),p=t("l1VB"),y=t("Yn1A"),m=new Uint8Array(16);function f(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(m)}var d=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function b(e){return"string"==typeof e&&d.test(e)}for(var h=[],v=0;v<256;++v)h.push((v+256).toString(16).substr(1));function g(e,r,t){var n=(e=e||{}).random||(e.rng||f)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,r){t=t||0;for(var a=0;a<16;++a)r[t+a]=n[a];return r}return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(h[e[r+0]]+h[e[r+1]]+h[e[r+2]]+h[e[r+3]]+"-"+h[e[r+4]]+h[e[r+5]]+"-"+h[e[r+6]]+h[e[r+7]]+"-"+h[e[r+8]]+h[e[r+9]]+"-"+h[e[r+10]]+h[e[r+11]]+h[e[r+12]]+h[e[r+13]]+h[e[r+14]]+h[e[r+15]]).toLowerCase();if(!b(t))throw TypeError("Stringified UUID is invalid");return t}(n)}var k=new o.a("S3Album"),w=function(){function e(r){var t=this;_classCallCheck(this,e),Object(a.k)(this,r),this.contentType="binary/octet-stream",this.level=s.a.Public,this.picker=!0,this.pickerText=l.a.PICKER_TEXT,this.albumItems=[],this.imgArr={},this.list=_asyncToGenerator(regeneratorRuntime.mark((function e(){var r,n,a,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.path,n=void 0===r?"":r,a=t.level,o=t.track,i=t.identityId,k.debug("Album path: "+n),p.a&&"function"==typeof p.a.list){e.next=3;break}throw new Error(u.n);case 3:return e.prev=3,e.next=6,p.a.list(n,{level:a,track:o,identityId:i});case 6:c=e.sent,t.marshal(c),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),k.warn(e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])}))),this.marshal=function(e){e.forEach((function(e){var r=e.key.toLowerCase().split(".")[1];y.d.has(r)&&(!e.contentType||e.contentType&&"binary/octet-stream"===e.contentType)&&(e.contentType=t.getContentType(e))}));var r=e.filter((function(e){return e.contentType&&e.contentType.startsWith("image/")})),n=t.filter?t.filter(r):r;n=t.sort?t.sort(n):n,t.albumItems=n,k.debug("album items",t.albumItems),t.constructImgArray(t.albumItems)},this.constructImgArray=function(e){e.map((function(e){t.imgArr["".concat(e.key)]=e.key}))},this.handlePick=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(r){var n,a,o,i,c,s,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.target.files[0],a=t.path,o=void 0===a?"":a,i=t.level,c=t.track,s=t.fileToKey,l=o+Object(y.b)(n,s),e.prev=1,e.next=4,Object(y.e)(l,n,i,c,n.type,k);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),k.error(e.t0),new Error(e.t0);case 9:Object.keys(t.imgArr).includes(l)?(t.albumItems=_toConsumableArray(t.albumItems),t.imgArr[l]="".concat(l,"-").concat(g())):(u=[].concat(_toConsumableArray(t.albumItems),_toConsumableArray(t.filter?t.filter([{key:l}]):[{key:l}])),t.albumItems=t.sort?t.sort(u):u);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(r){return e.apply(this,arguments)}}()}return _createClass(e,[{key:"getContentType",value:function(e){return Object(i.c)(e.key,"image/*")}},{key:"componentWillLoad",value:function(){this.list()}},{key:"render",value:function(){var e=this;return Object(a.i)("div",null,Object(a.i)("div",{class:"album-container"},Object(a.i)("div",{class:"grid-row"},this.albumItems.map((function(r){return Object(a.i)("div",{class:"grid-item",key:"key-".concat(r.key)},Object(a.i)("amplify-s3-image",{key:e.imgArr[r.key],imgKey:r.key,level:e.level,path:e.path,identityId:e.identityId,track:e.track,handleOnError:e.handleOnError,handleOnLoad:e.handleOnLoad}),Object(a.i)("span",{class:"img-overlay"}))})))),this.picker&&Object(a.i)("amplify-picker",{pickerText:c.a.get(this.pickerText),inputHandler:function(r){return e.handlePick(r)},acceptValue:"image/*"}))}}]),e}();w.style=":host{--overlay-bg-color:rgba(0, 0, 0, 0.15)}.album-container{-webkit-box-sizing:border-box;box-sizing:border-box;max-width:100%;margin:0 auto;padding:0 2rem}.grid-row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:-1rem -1rem;padding-bottom:3rem}.grid-item{position:relative;-ms-flex:1 0 22rem;flex:1 0 22rem;-ms-flex-positive:1;flex-grow:1;margin:1rem;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}amplify-s3-image{--width:22rem;--height:20rem;border-radius:5px;-o-object-fit:cover;object-fit:cover}.img-overlay{display:none;width:100%;height:21rem;position:absolute;top:0;left:0;background-color:var(--overlay-bg-color)}.grid-item:hover .img-overlay{display:block}"}}]);